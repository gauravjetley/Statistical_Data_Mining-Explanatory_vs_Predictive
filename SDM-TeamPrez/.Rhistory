log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 510)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
train <- sample.int(n = nrow(data), 600)
new.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) +
log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) +
as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX +
PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) +
VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) +
COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) +
HI:as.numeric(NEW) + HI:as.numeric(COUPON),
data = data[train,])
pred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])
pred.new.ilm.fit8
test <- data.frame(actual=data$FARE[-train], pred.new.ilm.fit8)
test$error <- with(test, pred.new.ilm.fit8-actual)
test
test <- data.frame(actual=log(data$FARE[-train]), pred.new.ilm.fit8)
test$error <- with(test, pred.new.ilm.fit8-actual)
test
test.mse <- with(test, mean(error^2))
test.mse
test.rmse <- sqrt(test.mse)
test.rmse
rss <- sum(test.mse^2)
rss
rss <- sum(residuals(ilm.fit8)^2)
rss
test.mse
mse
test.rmse
rmse
test.rss
rss
test.rss <- sum(test.mse^2)
test.rss
rss
test
library(tree)
install.packages(tree)
install.packages("tree")
library(tree)
as.numeric(DISTANCE)+as.numeric(PAX), data=data))
as.numeric(DISTANCE)+as.numeric(PAX) ,data=data))
summary(tree(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+
as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+as.numeric(DISTANCE)+as.numeric(PAX) ,data=data))
train.80 <- sample.int(n = nrow(data), 510)
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], control=rpart.control(minsplit=30, maxdepth=4))
new.tree.fit2 <- rpart(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+
as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], control=rpart.control(minsplit=30, maxdepth=4))
library(rpart)
new.tree.fit2 <- rpart(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+
as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], control=rpart.control(minsplit=30, maxdepth=4))
pred.new.tree.fit2 <- predict(new.tree.fit2, newdata=data[-train.80, ])
pred.new.tree.fit2
test <- data.frame(actual=log(data$FARE[-train]), pred.new.ilm.fit8)
test$error <- with(test, pred.new.ilm.fit8-actual)
test
test <- data.frame(actual=log(data$FARE[-train]), pred.new.ilm.fit8)
test$error <- with(test, pred.new.ilm.fit8-actual)
test
tree.test <- data.frame(actual=log(data$FARE[-train]), pred.new.ilm.fit8)
tree.test$error <- with(tree.test, pred.new.ilm.fit8-actual)
tree.test
tree.test <- data.frame(actual=log(data$FARE[-train.80]), pred.new.ilm.fit8)
pred.new.tree.fit2 <- predict(new.tree.fit2, newdata=data[-train.80, ])
pred.new.tree.fit2
#combining original data and prediction data in dataframe
pred.new.tree.fit2 <- predict(new.tree.fit2, newdata=data[train.80, ])
pred.new.tree.fit2
#combining original data and prediction data in dataframe
tree.test <- data.frame(actual=log(data$FARE[-train.80]), pred.new.ilm.fit8)
new.tree.fit2 <- rpart(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+
as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], control=rpart.control(minsplit=30, maxdepth=4))
pred.new.tree.fit2 <- predict(new.tree.fit2, newdata=data[-train.80, ])
pred.new.tree.fit2
tree.test <- data.frame(actual=log(data$FARE[-train.80]), pred.new.ilm.fit8)
tree.test1 <- data.frame(actual=log(data$FARE[-train.80]), pred.new.ilm.fit8)
train.80 <- sample.int(n = nrow(data), 510)
new.tree.fit2 <- rpart(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+
as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], control=rpart.control(minsplit=30, maxdepth=4))
pred.new.tree.fit2 <- predict(new.tree.fit2, newdata=data[-train.80, ])
pred.new.tree.fit2
tree.test <- data.frame(actual=log(data$FARE[-train.80]), pred.new.ilm.fit8)
tree.test <- data.frame(actual=log(data$FARE[-train.80]), pred.new.tree.fit2)
tree.test$error <- with(tree.test, pred.new.tree.fit2-actual)
tree.test
tree.test <- data.frame(actual=data$FARE[-train.80], pred.new.tree.fit2)
tree.test$error <- with(tree.test, pred.new.tree.fit2-actual)
tree.test
tree.test.mse <- with(tree.test, mean(error^2))
tree.test.mse
tree.mse
tree.test.rmse <- sqrt(tree.test.mse)
tree.test.rmse
tree.test.mse
tree.test.rmse
tree.test
tree.test.log <- data.frame(actual=log(data$FARE[-train.80]), pred.new.tree.fit2)
tree.test.log
tree.test.log <- data.frame(actual=data$FARE[-train.80], pred.new.tree.fit2)
tree.test.log$error <- with(tree.test, log(pred.new.tree.fit2)-log(actual))
tree.test.log
tree.test.mse <- with(tree.test.log, mean(error^2))
tree.test.mse
#Root mean squared error (RMSE) is then the square root of MSE:
# Root mean squared error
tree.test.rmse <- sqrt(tree.test.mse)
tree.test.rmse
tree.test.mse
tree.test.rmse
tree.test
library(randomForest)
rforest.test <- data.frame(actual=data$FARE[-train.80], pred.rforest.fit)
library(randomForest)
rforest.fit <- randomForest(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+
as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], importance=TRUE, ntree=2000)
rforest.fit <- randomForest(as.numeric(FARE)~S_CODE+as.factor(S_CITY)+as.factor(E_CODE)+
as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], importance=TRUE, ntree=2000)
rforest.fit <- randomForest(as.numeric(FARE)~S_CODE+S_CITY+E_CODE+
E_CITY+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+
as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+
as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+
as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], importance=TRUE, ntree=2000)
rforest.fit <- randomForest(as.numeric(FARE)~S_CODE+S_CITY+E_CODE+
E_CITY+COUPON+NEW+VACATION+
SW+HI+S_INCOME+E_INCOME+
S_POP+E_POP+SLOT+GATE+
DISTANCE+PAX,data=data[train.80,], importance=TRUE, ntree=2000)
rforest.fit <- randomForest(as.numeric(FARE)~S_CODE+E_CODE+COUPON+NEW+VACATION+
SW+HI+S_INCOME+E_INCOME+
S_POP+E_POP+SLOT+GATE+
DISTANCE+PAX,data=data[train.80,], importance=TRUE, ntree=2000)
pred.rforest.fit <- predict(rforest.fit, newdata=data[-train.80, ])
pred.rforest.fit
rforest.test <- data.frame(actual=data$FARE[-train.80], pred.rforest.fit)
rforest.test$error <- with(rforest.test, pred.rforest.fit-actual)
rforest.test
rforest.test.log <- data.frame(actual=data$FARE[-train.80], pred.rforest.fit)
rforest.test.log$error <- with(rforest.test, log(pred.rforest.fit)-log(actual))
rforest.test.log
#Computing new statistics and Comparing to Exploratory Model
# Mean squared error
rforest.test.mse <- with(rforest.test.log, mean(error^2))
rforest.test.mse
#Root mean squared error (RMSE) is then the square root of MSE:
# Root mean squared error
rforest.test.rmse <- sqrt(rforest.test.mse)
rforest.test.rmse
rforest.test.mse
rforest.test.rmse
rforest.test
summary(tree.fit)
print(tree.fit)
plot(tree.fit2)
plot(tree.fit)
text(tree.fit)
