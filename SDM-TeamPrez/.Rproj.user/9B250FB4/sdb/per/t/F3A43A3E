{
    "contents" : "data <- read.csv(\"~/Studies/Courses/USF/Statistical Data Mining/In-Class Presentation/2.WeeklyTeamPrez new/2.WeeklyTeamPrez/airline data.csv\")\nView(airline.data)\n\nplot(data)\n\ninstall.packages(\"car\")\nlibrary(car)\n\nnames(data)\n\n\n#Explanatory Models\n#Why some routs have higher Fare?\n\nscatterplot.matrix(FARE~S_CITY+E_CITY+COUPON+NEW+VACATION+DISTANCE|FARE,data=data)\nplot(FARE~S_CITY+E_CITY+COUPON+NEW+VACATION+DISTANCE,data=data)\npairs(FARE~S_CITY+E_CITY+COUPON+NEW+VACATION+DISTANCE,data=data)\nscatterplot.matrix(FARE~COUPON+VACATION+DISTANCE|FARE,data=data)\n\ninstall.packages(\"FactoMineR\")\nlibrary(FactoMineR)\npca<-PCA(data[,-1:-4])\npca$var\n\nboxplot(data[],notch = T,horizontal = T)\n\ninstall.packages(\"corrplot\")\nlibrary(corrplot)\ncor(data[,-1:-4])\ncorrplot(cor(data[,-1:-4]),method=\"circle\")\ncorrplot(cor(data[,-1:-4]),method=\"ellipse\")\ncorrplot.mixed(cor(data[,-1:-4]),lower=\"ellipse\",upper=\"number\")\n##Correlation Matrix Plots is an effective technique visually show the correlations between Variables\n\npar(mar=c(4,4,0,0))\nplot(as.factor(data[,\"E_CITY\"]))\nplot(data[,\"S_CITY\"],data[,\"FARE\"])\nplot(data[,\"DISTANCE\"],data[,\"FARE\"])\nplot(data[,\"S_POP\"],data[,\"FARE\"])\nplot(data[,\"E_POP\"],data[,\"FARE\"])\nplot(data[,\"COUPON\"],data[,\"FARE\"])\nboxplot(data[,\"COUPON\"]~data[,\"SW\"]) #No apparent difference between SW~COUPON\nplot(data[,\"VACATION\"],data[,\"FARE\"])\nboxplot(data[,\"FARE\"]~data[,\"VACATION\"],notch=T) #Vacation Destinations have lower avg fare\nboxplot(data[,\"FARE\"]~data[,\"SW\"],notch=T) #South West serviced locations have lower avg fares\nplot(data[,\"DISTANCE\"],data[,\"SW\"])\nboxplot(data[,\"DISTANCE\"]~data[,\"SW\"],notch=T) #South West serviced locations have lower avg distance\nboxplot(data[,\"COUPON\"]~data[,\"SW\"])\n\n########\n#T-Tests\nt.test <- with(data,t.test(as.numeric(FARE),as.numeric(DISTANCE)))\nt.test\n\nt.test2 <- with(data,t.test(as.numeric(FARE)~as.factor(SW)))\nt.test2\n\nt.test3 <- with(data,t.test(as.numeric(FARE),as.numeric(COUPON)))\nt.test3\n\nt.test4 <- with(data,t.test(as.numeric(FARE),as.numeric(NEW)))\nt.test4\n\n#######\n#ANOVA\naova <- with(data,aov(as.numeric(FARE)~as.numeric(DISTANCE)))\nsummary(anova)\nplot(anova)\n\nanova1 <- with(data,aov(as.numeric(FARE)~as.numeric(DISTANCE)+as.factor(SW))) #Blocked on SW\nsummary(anova1)\nplot(anova1)\n\nanova2 <- with(data,aov(as.numeric(FARE)~as.numeric(COUPON)+as.factor(SW))) #Blocked on SW\nsummary(anova2)\nplot(anova2)\n\n\n#MANOVA\n#ANCOVA\n#MANCOVA\n########################################################\n#Linear Regression (Variable Selection, Model Selection)\nlm.fit <- lm(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+as.numeric(DISTANCE)+as.numeric(PAX),data=data)\nsummary(lm.fit) #R2 86.21%\nplot(lm.fit)\ninfluencePlot(lm.fit)\nlibrary(MASS)\nstep <- stepAIC(lm.fit,direction = \"both\") #AIC=4363.76****\nstep2 <- stepAIC(lm.fit,direction = \"forward\") #AIC=4382.22\nstep2 <- stepAIC(lm.fit,direction = \"backward\") #AIC=4363.76****\n\n\n\n      ##New Model with highest AIC variables\nlm.fit2 <- lm(as.numeric(FARE) ~ as.factor(S_CITY) + as.factor(E_CITY) + as.numeric(COUPON) + \n                as.factor(NEW) + as.factor(VACATION) + as.factor(SW) + as.numeric(HI) + \n                as.numeric(DISTANCE) + as.numeric(PAX) ,data=data)\nsummary(lm.fit2)#R2 86.45% **not much increase\nplot(lm.fit2)\ninfluencePlot(lm.fit2)\nAIC(lm.fit2) #6176.324\n\n\n\n\n#############################################################\n#Linear Regression (Interaction Terms and Stepwise Selection)\n##Visualizations\nlibrary(ggplot2)\n##Distance and SW interaction\ngp <- ggplot(data=data, aes(x=DISTANCE, y=FARE, colour=factor(SW))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n##Distance and SW interaction\ngp <- ggplot(data=data, aes(x=DISTANCE, y=FARE*FARE, colour=factor(SW))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n##Distance and SW interaction\ngp <- ggplot(data=data, aes(x=DISTANCE, y=log(FARE), colour=factor(SW))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n##Coupon and SW interaction\ngp <- ggplot(data=data, aes(x=COUPON, y=FARE, colour=factor(SW))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n##Coupon and SW interaction\ngp <- ggplot(data=data, aes(x=DISTANCE, y=FARE, colour=factor(VACATION))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n\n##All interaction Terms!!!\nilm.fit <- lm(FARE~.+.*.,data=data)\nsummary(ilm.fit) #R2 100% hahaha\nsummary(ilm.fit)$coefficients\n\n##Distance & Coupon\nilm.fit2 <- lm(as.numeric(FARE) ~ as.factor(S_CODE) + as.factor(S_CITY) + as.factor(E_CODE) + \n                 as.factor(E_CITY) + as.numeric(COUPON) + as.factor(NEW) + as.factor(VACATION) + \n                 as.factor(SW) + as.numeric(HI) + as.numeric(S_INCOME) + as.numeric(E_INCOME) + \n                 as.numeric(S_POP) + as.numeric(E_POP) + as.factor(SLOT) + as.factor(GATE) + \n                 as.numeric(DISTANCE) + as.numeric(PAX) + (as.numeric(DISTANCE) * as.numeric(COUPON)), \n               data=data)\nsummary(ilm.fit2) #R2 86.60% increase\n\n##DISTANCE * SW\nilm.fit3 <- lm(as.numeric(FARE) ~ as.factor(S_CODE) + as.factor(S_CITY) + as.factor(E_CODE) + \n                 as.factor(E_CITY) + as.numeric(COUPON) + as.factor(NEW) + as.factor(VACATION) + \n                 as.factor(SW) + as.numeric(HI) + as.numeric(S_INCOME) + as.numeric(E_INCOME) + \n                 as.numeric(S_POP) + as.numeric(E_POP) + as.factor(SLOT) + as.factor(GATE) + \n                 as.numeric(DISTANCE) + as.numeric(PAX) + (as.numeric(DISTANCE) * as.numeric(COUPON)) +\n                 (as.numeric(DISTANCE)*as.factor(SW)), \n               data=data)\nsummary(ilm.fit3) #R2 86.64% increase\n\n\n##NEW * SW\nilm.fit4 <- lm(as.numeric(FARE) ~ as.factor(S_CODE) + as.factor(S_CITY) + as.factor(E_CODE) + \n                 as.factor(E_CITY) + as.numeric(COUPON) + as.factor(NEW) + as.factor(VACATION) + \n                 as.factor(SW) + as.numeric(HI) + as.numeric(S_INCOME) + as.numeric(E_INCOME) + \n                 as.numeric(S_POP) + as.numeric(E_POP) + as.factor(SLOT) + as.factor(GATE) + \n                 as.numeric(DISTANCE) + as.numeric(PAX) + (as.numeric(DISTANCE) * as.numeric(COUPON)) +\n                 (as.numeric(DISTANCE)*as.factor(SW)) + (as.factor(NEW)*as.factor(SW)),\n               data=data)\nsummary(ilm.fit4) #R2 86.71% increase\nplot(ilm.fit4) # good fit\nAIC(ilm.fit4) #6174.615\n\n## Adding all relevant interaction terms to the model\n## Potential interaction variables are DISTANCE, SLOT, HI, SW, VACATION, NEW, COUPON\n## Finding all good interactions by using stepwise selection on AIC by individual variables\nilm.fit5 <- lm(as.numeric(FARE)~as.numeric(DISTANCE)*.,data=data)\nplot(ilm.fit5) #good fit\nAIC(ilm.fit5) #5931\nstepAIC(ilm.fit5, direction = \"both\") #AIC 4081.87\n\nilm.fit6 <- lm(as.numeric(FARE)~as.factor(SLOT)*.,data=data)\nplot(ilm.fit6) #good fit\nstepAIC(ilm.fit6, direction = \"both\") #AIC 4358.43\n\nilm.fit6 <- lm(as.numeric(FARE)~as.numeric(HI)*.,data=data)\nplot(ilm.fit6) #good fit\nstepAIC(ilm.fit6, direction = \"both\") #AIC 4273.05\n\nilm.fit6 <- lm(as.numeric(FARE)~as.numeric(SW)*.,data=data)\nplot(ilm.fit6) \nstepAIC(ilm.fit6, direction = \"both\") #AIC 4155.2\n\nilm.fit6 <- lm(as.numeric(FARE)~as.numeric(VACATION)*.,data=data)\nplot(ilm.fit6) #good fit\nstepAIC(ilm.fit6, direction = \"both\") #AIC 4178.12\n\nilm.fit6 <- lm(as.numeric(FARE)~as.numeric(NEW)*.,data=data)\nplot(ilm.fit6)\nstepAIC(ilm.fit6, direction = \"both\") #AIC 4355.1\n\nilm.fit6 <- lm(as.numeric(FARE)~as.numeric(COUPON)*.,data=data)\nplot(ilm.fit6) #good fit\nstepAIC(ilm.fit6, direction = \"both\") #AIC 4188.3\n\nilm.fit7 <- lm(as.numeric(FARE) ~ as.factor(S_CODE) + as.factor(S_CITY) + as.factor(E_CODE) + \n                 as.factor(E_CITY) + as.numeric(COUPON) + as.factor(NEW) + as.factor(VACATION) + \n                 as.factor(SW) + as.numeric(HI) + as.numeric(S_INCOME) + as.numeric(E_INCOME) + \n                 as.numeric(S_POP) + as.numeric(E_POP) + as.factor(SLOT) + as.factor(GATE) + \n                 as.numeric(DISTANCE) + as.numeric(PAX) + \n                 as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):COUPON + as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(SLOT):PAX + as.numeric(SLOT):DISTANCE + as.numeric(SLOT):VACATION +\n                 as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + as.numeric(HI):VACATION + as.numeric(HI):SW + \n                 as.numeric(HI):HI + as.numeric(HI):PAX +\n                 as.numeric(SW):S_CITY + as.numeric(SW):E_CITY + as.numeric(SW):COUPON + as.numeric(SW):VACATION + \n                 as.numeric(SW):DISTANCE + as.numeric(SW):PAX +\n                 as.numeric(VACATION):S_CITY + as.numeric(VACATION):E_CODE + as.numeric(VACATION):COUPON + \n                 as.numeric(VACATION):SW + as.numeric(VACATION):HI + as.numeric(VACATION):DISTANCE + \n                 as.numeric(VACATION):PAX +\n                 as.numeric(NEW):S_CODE + as.numeric(NEW):HI + as.numeric(NEW):PAX + as.numeric(NEW):VACATION +\n                 as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + as.numeric(COUPON):VACATION + \n                 as.numeric(COUPON):SW + as.numeric(COUPON):HI + as.numeric(COUPON):DISTANCE, data=data)\nsummary(ilm.fit7) #R2 98.91% !!\nplot(ilm.fit7)\nAIC(ilm.fit7) #AIC 4578.465\n\n#interaction terms + squared variables\nistep1 <- stepAIC(ilm.fit7,direction = \"both\") #AIC 2725.83\nilm.fit8 <- lm(as.numeric(FARE) ~ as.factor(S_CITY) + as.factor(E_CITY) + as.numeric(COUPON) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + as.numeric(HI):HI + \n                 as.numeric(HI):PAX + as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9903\nplot(ilm.fit8)\nAIC(ilm.fit8) #4538.392\n\n#interaction terms + squared variables + Log(FARE)\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + as.numeric(COUPON) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + as.numeric(HI):HI + \n                 as.numeric(HI):PAX + as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9912 higher\nplot(ilm.fit8)\nAIC(ilm.fit8) #-1931.995\n\n#interaction terms\nilm.fit8 <- lm(as.numeric(FARE) ~ as.factor(S_CITY) + as.factor(E_CITY) + as.numeric(COUPON) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9901\nplot(ilm.fit8)\nAIC(ilm.fit8) #4553.261 Lower\n\n#Removing Sw and NEW interaction terms\nilm.fit8 <- lm(as.numeric(FARE) ~ as.factor(S_CITY) + as.factor(E_CITY) + as.numeric(COUPON) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 #COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 #HI:as.numeric(NEW) + \n                 as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.96.86\nplot(ilm.fit8)\nAIC(ilm.fit8) #5314.338 HIgher\n\n#Removing SW NEW interaction terms and adding log FARE\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + as.numeric(COUPON) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 #COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 #HI:as.numeric(NEW) + \n                 as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.97\nplot(ilm.fit8)\nAIC(ilm.fit8) #-1125 Higher\n\n#adding log COUPON \nilm.fit8 <- lm(as.numeric((FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9903\nplot(ilm.fit8)\nAIC(ilm.fit8) #4534.745 Lowest\n\n\n#Removing All CITY interaction variables\nilm.fit8 <- lm(as.numeric((FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9123\nplot(ilm.fit8) #Very good\nAIC(ilm.fit8) #5925.274 Lowest of Good fit till now!\n\n#Adding S_CITY one by one\nilm.fit8 <- lm(as.numeric((FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9123\nplot(ilm.fit8)\nAIC(ilm.fit8) #5925.274 Lower\n\n#Exponential Models\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + (as.numeric(COUPON)) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9328 Higher\nplot(ilm.fit8) #Very good\nAIC(ilm.fit8) #-655.0511 Low\n\n#Exponential Models with log COUPON\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + as.numeric(HI) + as.numeric(DISTANCE) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9342 Higher\nplot(ilm.fit8) #Ext. good\nAIC(ilm.fit8) #-668.6591 Low\n\n\n#Exponential Model with log COUPON DISTANCE HI\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + log(as.numeric(HI)) + log(as.numeric(DISTANCE)) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9371 Higher\nplot(ilm.fit8) #Ext. good\nAIC(ilm.fit8) #-697.9255 Lowest till now!\n\n#Exponential Model with log COUPON DISTANCE HI and log in Interactions\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + log(as.numeric(HI)) + log(as.numeric(DISTANCE)) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 log(as.numeric(DISTANCE)):log(HI) + log(as.numeric(DISTANCE)):PAX + \n                 log(as.numeric(DISTANCE)):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 log(as.numeric(HI)):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 log(COUPON):as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):log(DISTANCE) + \n                 S_CITY:as.numeric(VACATION) + log(COUPON):as.numeric(VACATION) + \n                 log(DISTANCE):as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 log(HI):as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 log(as.numeric(COUPON)):log(HI),\n               data = data)\nsummary(ilm.fit8) #R2 0.9253 Higher\nplot(ilm.fit8) #good\nAIC(ilm.fit8) #-588.2157 higher\n\n#Exponential Model with log COUPON DISTANCE HI and only one log interaction per interaction\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + log(as.numeric(HI)) + log(as.numeric(DISTANCE)) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 log(as.numeric(DISTANCE)):(HI) + log(as.numeric(DISTANCE)):PAX + \n                 log(as.numeric(DISTANCE)):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 log(as.numeric(HI)):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 log(COUPON):as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):log(DISTANCE) + \n                 S_CITY:as.numeric(VACATION) + log(COUPON):as.numeric(VACATION) + \n                 log(DISTANCE):as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 log(HI):as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 log(as.numeric(COUPON)):(HI),\n               data = data)\nsummary(ilm.fit8) #R2 0.9242 Lower\nplot(ilm.fit8) #good\nAIC(ilm.fit8) #-578.8088 Higher!\n\n#Exponential Model with log COUPON DISTANCE HI and only one log interaction per interaction\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + log(as.numeric(HI)) + log(as.numeric(DISTANCE)) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 (as.numeric(DISTANCE)):(HI) + (as.numeric(DISTANCE)):PAX + \n                 (as.numeric(DISTANCE)):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 log(as.numeric(HI)):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 log(COUPON):as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):log(DISTANCE) + \n                 S_CITY:as.numeric(VACATION) + log(COUPON):as.numeric(VACATION) + \n                 log(DISTANCE):as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 log(HI):as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 log(as.numeric(COUPON)):(HI),\n               data = data)\nsummary(ilm.fit8) #R2 0.9242 Lower\n#plot(ilm.fit8) #good\nAIC(ilm.fit8) #-610.6472 Lower but still higher tahn best model!\n\n#Exponential Model with log COUPON DISTANCE HI and only log HI in interactions\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + log(as.numeric(HI)) + log(as.numeric(DISTANCE)) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 (as.numeric(DISTANCE)):(HI) + (as.numeric(DISTANCE)):PAX + \n                 (as.numeric(DISTANCE)):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 (as.numeric(HI)):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 log(COUPON):as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):(DISTANCE) + \n                 S_CITY:as.numeric(VACATION) + log(COUPON):as.numeric(VACATION) + \n                 (DISTANCE):as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 (HI):as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 log(as.numeric(COUPON)):(HI),\n               data = data)\nsummary(ilm.fit8) #R2 0.9031 Higher\n#plot(ilm.fit8) #good\nAIC(ilm.fit8) #not good!\n\n#Exponential Model with log COUPON HI\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + log(as.numeric(HI)) + (as.numeric(DISTANCE)) + \n                 as.numeric(PAX) + \n                 #as.numeric(DISTANCE):S_CITY + as.numeric(DISTANCE):E_CITY + \n                 as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + \n                 #as.numeric(HI):S_CITY + as.numeric(HI):E_CITY + \n                 as.numeric(HI):VACATION + \n                 #S_CITY:as.numeric(SW) + E_CITY:as.numeric(SW) + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + \n                 #as.numeric(COUPON):S_CITY + as.numeric(COUPON):E_CITY + \n                 as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9381 Highest!!\n#plot(ilm.fit8) #Ext. good\nAIC(ilm.fit8) #-707.5091 Lowest of Good fit Exponential models!\n\n\n\n#Exponential Model with log COUPON DISTANCE\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + log(as.numeric(COUPON)) + \n                 as.factor(NEW) + (as.numeric(HI)) + log(as.numeric(DISTANCE)) + \n                 as.numeric(PAX) + as.numeric(DISTANCE):HI + as.numeric(DISTANCE):PAX + \n                 as.numeric(HI):PAX + as.numeric(HI):VACATION + \n                 COUPON:as.numeric(SW) + VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + \n                 S_CITY:as.numeric(VACATION) + COUPON:as.numeric(VACATION) + \n                 DISTANCE:as.numeric(VACATION) + PAX:as.numeric(VACATION) + HI:as.numeric(NEW) + as.numeric(COUPON):HI,\n               data = data)\nsummary(ilm.fit8) #R2 0.9356 Lower!!\nplot(ilm.fit8) #Ext. good\nAIC(ilm.fit8) #-682.408 higher!\nBIC(ilm.fit8) #57.67614\n\n\n#Stepwise selection on best model\nistep2 <- stepAIC(ilm.fit8,direction = \"both\")\nilm.fit8 <- lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + \n                 log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) + \n                 as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX + \n                 PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) + \n                 VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) + \n                 COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                 HI:as.numeric(NEW) + HI:as.numeric(COUPON),\n               data = data)\nsummary(ilm.fit8) #R2 0.9383 Highest!!\nplot(ilm.fit8) #Ext. good !!!!\nAIC(ilm.fit8) #-710.6806 Lowest of Good fit Exponential models!\nBIC(ilm.fit8) #20.48689 Lowest!!!!\nlibrary(car)\ninfluencePlot(ilm.fit8)\n\n#interaction Terms visualizations\nlibrary(ggplot2)\ngp <- ggplot(data=data, aes(x=(HI), y=log(FARE), colour=factor(VACATION))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n\ngp <- ggplot(data=data, aes(x=(HI), y=log(FARE), colour=factor(NEW))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n\ngp <- ggplot(data=data, aes(x=COUPON, y=log(FARE), colour=factor(SW))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n\ngp <- ggplot(data=data, aes(x=COUPON, y=log(FARE), colour=factor(VACATION))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n\ngp <- ggplot(data=data, aes(x=DISTANCE, y=log(FARE), colour=factor(SW))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n\ngp <- ggplot(data=data, aes(x=PAX, y=log(FARE), colour=factor(VACATION))) \ngp + geom_point() + stat_smooth(method=\"lm\")\n\n\n###############\n#Decision Tree\nlibrary(rpart)\ntree.fit <- rpart(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+\n                    as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+\n                    as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+\n                    as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+\n                    as.numeric(DISTANCE)+as.numeric(PAX),data=data)\ntree.fit\nsummary(tree.fit)\nprint(tree.fit)\nplot(tree.fit)\ntext(tree.fit)\nlibrary(rattle)\nlibrary(rpart.plot)\nlibrary(RColorBrewer)\nfancyRpartPlot(tree.fit)\nplotcp(tree.fit) # Cross-Validation plot\n\n\n\ntree.fit2 <- rpart(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+\n                    as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+\n                    as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+\n                    as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+\n                    as.numeric(DISTANCE)+as.numeric(PAX),data=data, control=rpart.control(minsplit=30, maxdepth=4))\n\n\nfancyRpartPlot(tree.fit2)\nplot(tree.fit2)\ntext(tree.fit2)\n#Looking for lowest cross validation errors\nprintcp(tree.fit2)\n#Getting the lowest Complexity parameter for lowest Cross validation Error Rate\ntree.fit2$cptable[which.min(tree.fit2$cptable[,\"xerror\"]),\"CP\"]\n#looking at visualization of CP\nplotcp(tree.fit2)\n#Pruning Tree for minimum error rate\ntree.fit2.p <- prune(tree.fit2, cp = tree.fit2$cptable[which.min(tree.fit2$cptable[,\"xerror\"]),\"CP\"])\n#visualizing new tree\nfancyRpartPlot(tree.fit2.p, uniform=TRUE,main=\"Pruned Classification Tree\")\n\ntree.fit\nsummary(tree.fit)\nprint(tree.fit)\n\n#More visualization\nlibrary(party)\t\t\t\t\t# Alternative decision tree algorithm\nlibrary(partykit)\t\t\t\t# Convert rpart object to BinaryTree\nlibrary(caret)\nprp(tree.fit2.p)\t\t\t\t\t# Will plot the tree\nprp(tree.fit2.p,varlen=3)\n\n\n############################\n#Conditional Inference Tree\nlibrary(party)\n\nctree.fit <- ctree(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+\n                     as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+\n                     as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+\n                     as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+\n                     as.numeric(DISTANCE)+as.numeric(PAX),data=data)\nplot(ctree.fit)\nsummary(ctree.fit)\nctree.fit\nprint(ctree.fit)\n\n##############################################################################################################\n##############################################################################################################\n##############################################################################################################\n\n#Predictive Models\n#Predict Fare on a given route\n\n\n###########\n#Regression\n#The mean squared error (MSE) is the mean of the square of the residuals:\n# Mean squared error\nmse <- mean(residuals(ilm.fit8)^2)\nmse\n\n#Root mean squared error (RMSE) is then the square root of MSE:\n# Root mean squared error\nrmse <- sqrt(mse)\nrmse\n\n#Residual sum of squares (RSS) is the sum of the squared residuals:\n# Residual sum of squares\nrss <- sum(residuals(ilm.fit8)^2)\nrss\n\n#Residual standard error (RSE) is the square root of (RSS / degrees of freedom):\n# Residual standard error\nrse <- sqrt( sum(residuals(ilm.fit8)^2) / ilm.fit8$df.residual ) \nrse\n\n#Making a Training set Index\ntrain <- sample.int(n = nrow(data), 600)\n\nnew.ilm.fit8 <-  lm(as.numeric(log(FARE)) ~ as.factor(S_CITY) + as.factor(E_CITY) + \n                    log(as.numeric(COUPON)) + as.factor(NEW) + log(as.numeric(HI)) + \n                    as.numeric(DISTANCE) + as.numeric(PAX) + as.numeric(DISTANCE):PAX + \n                    PAX:as.numeric(HI) + as.numeric(HI):VACATION + COUPON:as.numeric(SW) + \n                    VACATION:as.numeric(SW) + as.numeric(SW):DISTANCE + S_CITY:as.numeric(VACATION) + \n                    COUPON:as.numeric(VACATION) + PAX:as.numeric(VACATION) + \n                    HI:as.numeric(NEW) + HI:as.numeric(COUPON),\n                  data = data[train,])\n\npred.new.ilm.fit8 <- predict(new.ilm.fit8, newdata=data[-train, ])\npred.new.ilm.fit8\n\n#combining original data and prediction data in dataframe\ntest <- data.frame(actual=log(data$FARE[-train]), pred.new.ilm.fit8)\ntest$error <- with(test, pred.new.ilm.fit8-actual)\ntest\n\n#Computing new statistics and Comparing to Exploratory Model\n# Mean squared error\ntest.mse <- with(test, mean(error^2))\ntest.mse\nmse\n#Root mean squared error (RMSE) is then the square root of MSE:\n# Root mean squared error\ntest.rmse <- sqrt(test.mse)\ntest.rmse\nrmse\n#Residual sum of squares (RSS) is the sum of the squared residuals:\n# Residual sum of squares\ntest.rss <- sum(test.mse^2)\ntest.rss\nrss\n\n\n#################################\n#Decision Tree\ninstall.packages(\"tree\")\nlibrary(tree)\nsummary(tree(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+\n               as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+\n               as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+\n               as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+as.numeric(DISTANCE)+as.numeric(PAX) ,data=data))\n# Cannot cross-validate as we have more than 32 levels in 2 variables\n\n## Using different method\n#Making a Training set Index\ntrain.80 <- sample.int(n = nrow(data), 510)\nlibrary(rpart)\nnew.tree.fit2 <- rpart(as.numeric(FARE)~as.factor(S_CODE)+as.factor(S_CITY)+as.factor(E_CODE)+\n                     as.factor(E_CITY)+as.numeric(COUPON)+as.factor(NEW)+as.factor(VACATION)+\n                     as.factor(SW)+as.numeric(HI)+as.numeric(S_INCOME)+as.numeric(E_INCOME)+\n                     as.numeric(S_POP)+as.numeric(E_POP)+as.factor(SLOT)+as.factor(GATE)+\n                     as.numeric(DISTANCE)+as.numeric(PAX),data=data[train.80,], control=rpart.control(minsplit=30, maxdepth=4))\n\n\npred.new.tree.fit2 <- predict(new.tree.fit2, newdata=data[-train.80, ])\npred.new.tree.fit2\n\n#combining original data and prediction data in dataframe\ntree.test <- data.frame(actual=data$FARE[-train.80], pred.new.tree.fit2)\ntree.test$error <- with(tree.test, pred.new.tree.fit2-actual)\ntree.test\n\ntree.test.log <- data.frame(actual=data$FARE[-train.80], pred.new.tree.fit2)\n\ntree.test.log$error <- with(tree.test, log(pred.new.tree.fit2)-log(actual))\ntree.test.log\n\n#Computing new statistics and Comparing to Exploratory Model\n# Mean squared error\ntree.test.mse <- with(tree.test.log, mean(error^2))\ntree.test.mse\n\n#Root mean squared error (RMSE) is then the square root of MSE:\n# Root mean squared error\ntree.test.rmse <- sqrt(tree.test.mse)\ntree.test.rmse\n\n\n\n#########################################################\n#Random Forest\nlibrary(randomForest)\n#Making a Training set Index\ntrain.80 <- sample.int(n = nrow(data), 510)\n\n\nrforest.fit <- randomForest(as.numeric(FARE)~S_CODE+E_CODE+COUPON+NEW+VACATION+\n                              SW+HI+S_INCOME+E_INCOME+\n                              S_POP+E_POP+SLOT+GATE+\n                              DISTANCE+PAX,data=data[train.80,], importance=TRUE, ntree=2000)\n\n\npred.rforest.fit <- predict(rforest.fit, newdata=data[-train.80, ])\npred.rforest.fit\n\n#combining original data and prediction data in dataframe\nrforest.test <- data.frame(actual=data$FARE[-train.80], pred.rforest.fit)\nrforest.test$error <- with(rforest.test, pred.rforest.fit-actual)\nrforest.test\n\nrforest.test.log <- data.frame(actual=data$FARE[-train.80], pred.rforest.fit)\nrforest.test.log$error <- with(rforest.test, log(pred.rforest.fit)-log(actual))\nrforest.test.log\n\n#Computing new statistics and Comparing to Exploratory Model\n# Mean squared error\nrforest.test.mse <- with(rforest.test.log, mean(error^2))\nrforest.test.mse\n\n#Root mean squared error (RMSE) is then the square root of MSE:\n# Root mean squared error\nrforest.test.rmse <- sqrt(rforest.test.mse)\nrforest.test.rmse\n\n\n\n\n\n\n\n\n",
    "created" : 1445159890472.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1438077954",
    "id" : "F3A43A3E",
    "lastKnownWriteTime" : 1445313172,
    "path" : "~/Studies/Courses/USF/Statistical Data Mining/In-Class Presentation/2.WeeklyTeamPrez new/SDM-TeamPrez/SDM-TeamPrez.R",
    "project_path" : "SDM-TeamPrez.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}